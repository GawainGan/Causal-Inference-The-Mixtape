# 介绍

我的经济学之路并非一帆风顺。例如，我并没有主修经济学。在大学里，我甚至没有上过一门经济学课程。我主修的是英语，天哪，我的雄心壮志是成为一名诗人。但后来，我对一个观点产生了浓厚的兴趣，那就是人类即便没有随机实验，也能形成关于因果效应的合理信念。二十五年前，我甚至不明白那句话是什么意思，更不用说如何进行这样的实验了。那么，我是怎么走到这一步的呢？或许你想知道我是如何达到觉得自己需要写这本书的地步的。简而言之，我是沿着一条从英语到因果推断的曲折道路前行的。首先，我爱上了经济学。然后，我爱上了实证研究。随后，我注意到自己一直对因果推断抱有日益浓厚的兴趣。但让我来讲讲更长的版本。

我在田纳西大学诺克斯维尔分校(University of Tennessee at Knoxville)主修英语，并满怀成为专业诗人的雄心壮志毕业。但是，在大学里成功写诗之后，我很快意识到，要找到成功的道路可能并不现实。我新婚燕尔，孩子即将出生，当时我在做市场研究的量化研究员。慢慢地，我完全停止了写诗。

量化研究员的工作让我大开眼界，部分原因是这是我第一次接触到实证主义(empiricism)。我的工作是进行“基础理论”研究——这是一种基于观察对人类行为生成解释的归纳方法。我通过组织焦点小组讨论和进行深入访谈以及其他人种学方法来完成这一点。我将每个项目视为理解人们为何做他们所做之事的机会（即使他们做的事情是购买洗涤剂或选择有线电视提供商）。虽然这份工作激发了我发展自己关于人类行为的理论，但它没有提供一种验证这些理论的方式。

由于我缺乏社会科学背景，所以我会利用晚上的时间下载并阅读互联网上的文章。我不记得我是怎么到那儿的，但有一天晚上我在芝加哥大学法律与经济学(University of Chicago Law and Economics)工作论文系列网站上时，Gary Becker的一篇演讲引起了我的注意。那是他的诺贝尔奖接受演讲，讲述了经济学如何适用于所有人类行为【Becker, 1993】，阅读这篇演讲改变了我的生活。我以为经济学是关于股市和银行的，直到我读了那篇演讲。我不知道经济学是可以用来分析所有人类行为的强大引擎。这让我兴奋不已，一颗种子在我心中种下了。

但直到我阅读了Lott 和 Mustard关于犯罪的文章【Lott and Mustard, 1997】，我才真正爱上了经济学。我不知道经济学有一个实证部分，经济学家试图用定量数据估计因果效应。这篇论文的合著者之一是David Mustard，当时是乔治亚大学(University of Georgia)经济学副教授，也是Gary Becker的前学生。我决定想要跟Mustard学习，于是我申请了乔治亚大学的经济学博士项目。我和我的妻子Paige以及我们的婴儿儿子Miles一起搬到了乔治亚州的阿森斯(Athens, Geoorgia)，并于2002年秋季开始上课。

通过了第一年的综合考试后，我参加了Mustard的劳动经济学领域课程，学习了许多将影响我多年兴趣的话题。这些话题包括教育回报、不平等、种族歧视、犯罪以及劳动领域的许多其他迷人话题。我们在那门课程中阅读了许多实证论文，之后我知道我需要强大的计量经济学背景来进行我关心的研究。事实上，我决定将计量经济学作为我的主要研究领域。这让我开始与乔治亚大学的计量经济学家和劳动经济学家Christopher Cornwell合作。我从Chris那里学到了很多，包括关于计量经济学和研究本身的知识。他成为了我的导师、合著者和亲密的朋友。

计量经济学很难。我甚至不假装我擅长它。我参加了乔治亚大学提供的所有计量经济学课程，有些课程我甚至上了不止一次。这些课程涵盖了概率与统计、横截面、面板数据、时间序列和定性因变量等主题。但虽然我通过了计量经济学领域的考试，我仍然难以深入理解计量经济学。正如俗语所说，我看不见森林只见树木。总有些东西没能触动我。

然而，在我写论文的第三章时，我注意到了一些之前没注意到的东西。我的第三章是对堕胎合法化对该群体未来性行为影响的研究【Cunningham and Cornwell, 2013】，这是对Donohue and Levitt【2001】的再访问。我为这项研究准备的书籍之一是Levine【2004】，除了回顾堕胎的理论和实证研究外，还有一个小表格解释了差异中的差异识别策略。乔治亚大学有一种传统的计量经济学教学法，我的大部分领域课程都是理论性的（例如，公共经济学、产业组织），所以我从来没有真正听说过“识别策略”，更不用说“因果推断”了。不知何故，Levine的简单差异中的差异表格让我开了眼。我看到了计量经济学建模可以用来隔离某种处理的因果效应，这改变了我处理实证问题的方式。

## 1.1 什么是因果推断？ (What is Causal Inference?)

我研究生毕业后的第一份工作是在德克萨斯州韦科的贝勒大学(Baylor University in Waco, Texas)担任助理教授，我至今仍在那里工作和生活。我曾经一到那里就感到不安。我能感觉到计量经济学是不可或缺的，但我还缺少些什么。是什么呢？那就是因果性理论。自从我看到了 Levine [2004] 中的双重差分表(difference-in-differences table)以来，我就一直在探索这一理论。但我需要更多。所以，处于迫切的需要，我做了我想学新东西时总会做的事——我开发了一门关于因果性的课程，强迫自己学习所有我不知道的东西。

我将这门课程命名为因果推断与研究设计(Causal Inference and Research Design)，并于2010年首次向贝勒大学的硕士生授课。当时，我真的找不到一个我所期望的课程示例，所以我拼凑了来自几个学科和作者的想法，如劳动经济学、公共经济学、社会学、政治学、流行病学和统计学等。我的课程不是一门纯粹的计量经济学课程；相反，它是一门应用实证课程，教授了各种当代研究设计，如双重差分法(difference-in-differences)，课程内容包括了大量的实证复现和阅读材料，所有这些都建立在 Donald Rubin 和 Judea Pearl 的稳固的因果性理论基础之上。实际上，这本书和那门课程非常相似。

那么我如何定义因果推断呢？因果推断是利用理论和对制度细节的深入了解来估计事件和选择对特定结果的影响。这不是一个新领域；人类自古就一直在迷恋因果关系。但新颖之处在于，我们相信无论是在实验室内部还是外部，我们在估算因果效应上都取得了进展。有人将现代因果推断的开始追溯到 Fisher [1935]、Haavelmo [1943] 或 Rubin [1974]。有些人将其与 John Snow 等早期先驱的工作联系起来。我们应该给予许多高度创造性的劳动经济学家们很多赞誉，他们的雄心勃勃的研究议程从1970年代末到1990年代末在经济学领域引发了一场至今仍在持续的革命。甚至可以说，我们应该感谢 Cowles 委员会、Philip 和 Sewall Wright 以及计算机科学家 Judea Pearl。

但无论你如何确定它的出现时间，因果推断现已成熟为一个独立的领域，并且不出所料，你开始看到越来越多的关于它的处理方式。有时它在计量经济学教科书中的“项目评估”长篇章节中被回顾 [Wooldridge, 2010]，或甚至被给予整本书的处理。仅举几个在这一领域不断增长的教科书为例，有 Angrist 和 Pischke [2009]、Morgan 和 Winship [2014]、Imbens 和 Rubin [2015]，可能还有其他半打，更不用说许多关于特定策略的详尽处理，如 Angrist 和 Krueger [2001] 以及 Imbens 和 Lemieux [2008] 所找到的。市场正悄悄增加有关使用数据识别因果效应的书籍和文章。

那么，*Causal Inference: The Mixtape* 存在的意义是什么？坦率地说，直到这本书出现之前，还没有一本易读的入门书籍，带有编程示例、数据和详细的阐述。我的书是为了填补这个空白，因为我相信研究人员真正需要的是一本指南，能将他们从几乎对因果推断一无所知的地方引导到具备能力的地方。具备能力的意义在于，他们能够对哪些设计能做什么、不能做什么有所了解和掌握。具备能力的意义在于，他们能够拿起数据，编写代码，并使用理论和背景知识，在他们自己的项目中实施一个合理的设计。如果这本书能帮助某人做到这一点，那么这本书就具有价值，这就是我所能并应该期望的一切。

我还喜欢哪些别的书？哪些书启发了这本书？我为什么不继续使用它们？对于我的课程，我主要依赖 Morgan 和 Winship [2014]、Angrist 和 Pischke [2009]，以及一系列理论和实证文章。在我看来，这些书是明确的经典之作。但它们没有满足我的需求，使得我不得不不断地在材料之间跳跃。其他的书很棒，但对我来说也不太对。Imbens 和 Rubin [2015] 讲述了潜在结果模型、实验设计以及匹配和工具变量，但没有涵盖有向无环图模型（DAGs）、断点回归、面板数据或合成控制。Morgan 和 Winship [2014] 涵盖了 DAGs、潜在结果模型和工具变量，但对我来说，它们在断点回归和面板数据方面触及得太轻了。它们也没有涵盖合成控制，而合成控制被 Athey 和 Imbens [2017b] 称为过去15年来因果推断中最重要的创新。Angrist 和 Pischke [2009] 非常接近我所需要的，但它没有包括任何关于合成控制或我认为至关重要的图形模型的内容。但也许最重要的是，Imbens 和 Rubin [2015]、Angrist 和 Pischke [2009] 以及 Morgan 和 Winship [2014] 都没有提供任何实际的编程指导，而我相信通过复制和编码，我们在这些领域获得了知识。

这本书是为几种不同的人写的。首先，它是为实践者写的，这就是为什么它包含了易于下载的数据集和程序。这也是为什么我多次尝试审查论文以及尽可能地复制模型。我希望读者能理解这个领域，但同样重要的是，我希望他们能够感到被赋予能力，以便他们可以使用这些工具来回答自己的研究问题。

我还考虑到了另一类人——那些希望重新装备自己的有经验的社会科学家。这些人可能更偏重理论研究，或者他们可能在自己的知识结构中存在一些空缺。我希望这本书能够引导他们了解社会科学中如此普遍的现代因果理论，并提供一套有向无环图模型的分析工具，帮助他们将理论知识与实证研究相结合。特别是，我认为对这类人来说，有向无环图模型尤其有价值。

我关注的第三组人是工业界、媒体、智库等非学术人士。越来越多地，对因果推断的了解在整个专业世界中都是预期的。这不再仅仅是学术界人士坐在一起讨论的事情。这是做出商业决策以及解读政策的关键知识。

最后，这本书是为职业生涯非常早期的人写的，无论是本科生、研究生还是新晋博士。我希望这本书能给他们一个快速起步，这样他们就不必像我们许多人一样，通过一条相当迷宫般的路径来探索这些方法。

## 1.2 不要混淆相关性和因果性 (Do Not Confuse Correlation with Causality)

现如今，常常听到有人说“相关性不代表因果性”。这本书的部分目的是帮助读者能够确切理解为什么相关性，特别是在观察性数据中的相关性，不太可能反映因果关系。当公鸡啼叫时，太阳很快就会升起，但我们知道公鸡并没有导致太阳升起。即使公鸡被农夫的猫吃掉了，太阳还是会升起。然而，人们在天真地解释简单的相关性时，经常会犯这种错误。

但奇怪的是，有时两件事之间确实存在因果关系，但却没有可观察到的相关性。这确实很奇怪。一件事如何在两者之间没有任何可辨识的相关性的情况下导致另一件事呢？考虑下面的例子，如图1.1所示。一个水手在风天里驾着她的船穿过湖面。风吹过时，她通过转动舵以完全抵消风的力量。她来回移动着舵，然而船却沿着湖面直线行驶。一个善良但天真的人如果不了解风或船，可能会看着这个女人说：“给这个水手换个新舵吧！她的舵坏了！”他这么想是因为他看不到舵的移动和船的方向之间的任何关系。

<p align="center">
    <img src="https://github.com/GawainGan/Causal-Inference-The-Mixtape/blob/main/Source/scottboat.jpg?raw=true" alt="Figure 1.1: No correlation doesn’t mean no causality." style="width: 80%;"/>
  <br>
  <small><i>图1.1：没有相关性并不意味着没有因果关系 Artwork by Seth.</i></small>
</p>

但是他看不到关系，就意味着没有关系吗？仅仅因为没有能够观察到的关系，并不意味着没有因果关系。想象一下，如果她没有通过转动舵来完美地抵消风力，而是掷硬币来决定——正面则向左转舵，反面则向右转舵。如果她根据硬币的结果来驾驶船只，你认为这个人会看到什么？如果她在有风的日子里***随机***移动舵，那么他会看到一个水手在湖面上之字形前进。为什么他能在舵随机移动是看到舵与船移动的关系，而在其他情况下却看不到呢？这是因为水手是根据看不到的风来***内部***(endogenously)调整舵的位置。因此，尽管舵和船的方向之间存在因果关系，但这种关系却因为水手的反应而被抵消掉了。

这听起来可能像是个不太严肃的例子，但实际上还有一些更为严肃的情况。想象一下中央银行像用茶叶占卜一样试图预测经济衰退的来临。当看到经济衰退的征兆时，银行便开始了公开市场操作，买入债券并向经济体注入流动性。只要这些操作得当，这些公开市场操作和实际的经济产出之间看似毫无联系。实际上，在最理想的情况下，银行可能会采取激进的交易措施来避免经济衰退，***即便这些措施真的发挥了作用***，我们也可能无法从表面上看出任何迹象。

人类进行最优行为是相关性几乎从不揭示因果关系的主要原因，因为人类很少随机行动。正如我们将看到的，随机性的存在对于识别因果效应至关重要。

## 1.3 优化使一切内生化 (Optimization Makes Everything Endogenous)

有时候，因果推断方法论的某些表述被描述为非理论性的，但在我看来，尽管一些实践者似乎习惯于盲目操作，但实际上在因果设计中使用的方法总是深深依赖于理论和因地制宜的知识。我坚定地认为，并将在本书中反复强调：缺乏先验知识的情况下，所估计的因果效应很难被认为是可靠的。要为任何因果发现的主张提供依据，就需要有先验知识。此外，经济理论也指出，进行因果推断本质上是一项复杂且困难的共情。容我详细说明一下。

人们通常认为有两种类型的数据。即实验性数据和非实验性数据。后者有时也称为***观察性*** (observational) 数据。实验数据是在类似实验室环境中收集的。在传统实验中，研究者积极参与被记录的过程。由于可行性、财务成本或道德异议，在社会科学中获取这类数据更加困难，尽管现在比过去常见。例如，诸如俄勒冈州医疗补助实验、RAND健康保险实验以及由Esther Duflo、Michael Kremer、Abhijit Banerjee和John List引领的实地实验活动等，都是此类实验的典型例子。

观察性数据通常是通过调查以回顾性方式收集的，或者作为其他业务活动的副产品（“大数据”）。在很多观察性研究里，我们通常收集的是过去发生事件的数据，而不是事件发生时即时的数据。但随着网络抓取技术的广泛应用，我们或许能更准确地捕捉到事件发生的瞬间的数据。然而，不管数据收集的时间如何，研究者都是数据生成过程中的旁观者。她们能记录下所发生的行为和结果，但却不能干预这些事件发生的环境。这种类型的数据是我们大多数人最常接触和使用的。

经济理论提示我们，应对观察性数据中发现的相关性持保留态度。在观察性数据里，相关性很难反映出真正的因果关系，因为所涉及的变量往往是人们根据自己的判断作出的最佳决策所内生产生的。在追求目标的同时面临各种限制，他们做出的选择往往与其他因素产生了似是而非的相关性。这个问题在潜在结果模型中也有所体现：要成为因果效应的衡量，相关性必须建立在与考虑中的潜在结果无关的选择之上。然而，如果一个人的选择是***基于***她认为最好的结果，那么这个选择必然是基于潜在结果的，这样的相关性根本无法满足我们判断其为因果关系的条件。直白地说，经济理论指出选择是内生的，因此这些选择与结果之间的相关性在大多数情况下都不会真正代表因果效应。

现在我们正探索知识论的领域。确定因果效应不仅需要一些假设，还需要对科学工作持有一种特定的信念。可靠和有价值的研究要求我们认为，正确执行我们的工作比追求特定的结果（比如，确认偏差、统计显著性等）更为重要。科学知识的根基在于科学的方法论。真正的科学家不会收集证据来证实他们希望成真的事物或别人希望相信的事物。这种行为是一种称为宣传的欺骗和操纵，而宣传并不属于科学。科学方法论其实是用来形成特定类型信念的工具。这些方法论让我们能够接受出乎意料、有时甚至是不受欢迎的答案。它们注重过程，而非结果。缺乏这些价值观，因果推理的方法也就难以令人信服。

## 1.4 识别需求的价格弹性

科学方法论的基石之一是实证分析。所谓实证分析，我指的是使用数据来检验理论或估计变量之间的关系[5](#comment-5)。进行实证经济分析的第一步是仔细构思我们想要回答的问题。在某些情况下，我们希望开发并测试一个形式化的经济模型，用数学描述某一特定关系、行为或感兴趣的过程。这些模型之所以有价值，是因为它们既描述了感兴趣的现象，又提出了可被验证（可检验）(falsifiable/testable)的预测。一个预测之所以可被验证，是因为我们可以用数据来评估并可能拒绝这个预测。模型是我们用来描述我们感兴趣的关系、我们结果的直觉以及我们想要测试的假设的框架。

在我们确定了一个模型之后，我们将其转化为所谓的计量经济模型，这可以直接用数据来估计。我们立即面临的一个明确问题是模型的函数形式，或者如何通过方程式来描述我们感兴趣的变量之间的关系。另一个重要问题是，我们将如何处理那些研究者无法直接或合理观察到的变量，或者那些无法很好测量但在我们模型中起着重要作用的变量。

为了深入理解因果推断，一个基本而重要的概念是比较静态分析。比较静态分析提供了模型内部因果效应的理论阐述，这种分析始终建立在“其他条件保持不变”这一前提之上。例如，当我们尝试阐释某项干预的因果效应时，我们的出发点是模型中其他相关变量保持不变。如果这些变量发生变化，它们就会与我们关注的变量产生相关性，进而混淆(confound)我们的估计结果。

为了解释这个概念，我们不妨从一个基础的经济学模型谈起：供求平衡及其对估算需求价格弹性所带来的挑战(supply and demand equilibrium and the problems it creates for estimating the price elasticity of demand)。政策制定者和商业管理者天生就对需求价格弹性的了解感兴趣，因为掌握这一指标有助于企业最大化利润，政府制定最优税收政策，甚至决定是否全面限制产量【Becker等人，2006】。然而，我们无法直接观察到需求曲线，因为需求曲线本质上是理论上的构想。更具体来说，需求曲线描述了价格与数量潜在结果之间的一系列配对[^6](#comment-6)。我们所能观察到的仅是***价格和数量的均衡值***，而非需求曲线上所有潜在价格与数量的组合。只有追踪需求曲线上的潜在结果，我们才能计算出弹性。

以Philip Wright在1928年的附录B中提供的图表为例（稍后将更详细讨论此图，见图2）。需求的价格弹性定义为***单一需求曲线***上，价格变动对数量变动百分比的比率。但是，当供给和需求出现变动时，就会在历史上形成一系列价格与数量的配对，这些配对既不反映需求曲线也不反映供给曲线的实际情况。实际上，这些点的连接并不能揭示任何有意义或实用的信息。


<p align="center">
    <img src="https://github.com/GawainGan/Causal-Inference-The-Mixtape/blob/main/Source/supply_demand.png?raw=true"  style="width: 80%;"/>
  <br>
  <small>图2：Wright的图解识别问题。图片来源于Wright, P. G. (1928). <a href="https://scholar.harvard.edu/files/stock/files/tariff_appendixb.pdf">The Tariff on Animal and Vegetable Oils.</a></small>
</p>

```
注：
图片原始title: Price-Output Data Fail to Reveal Either Supply or Demand Curve 价格-产出数据无法揭示供给或需求曲线
左上角为：Varying Demand Curve 变动的需求曲线
右上角为:Varying Supply Curve 变动的供应曲线
中间字段：Line filled to price-output scatter R1, R2, R3 适配于价格-产出散点图的线R1、R2、R3
```


需求的价格弹性是以下方程的解：

<p align="center">
  $$\epsilon = \frac{\partial \log Q}{\partial \log P}$$
</p>

但在这个例子中，价格P的变化是***外生的***(exogenous)。例如，它假设供给固定，其他商品的价格固定，收入固定，偏好固定，输入成本固定等等。为了估计需求的价格弹性，我们需要价格P的变化完全独立于供给的正常决定因素和需求的其他决定因素。否则，我们会得到供给或需求的变化，这会创建新的数据对，任何价格P和数量Q之间的相关性都不会是需求弹性的衡量指标。

问题在于，弹性是一个重要的指标，我们需要了解它，因此我们需要解决这个问题。因此，鉴于这个理论对象，我们必须首先写出一个计量经济模型。一个可能的计量经济模型示例是线性需求函数：

<p> 
    $$\log Q_d = \alpha + \delta \log P + \gamma X + u$$
</p>


$$\text{其中，}\alpha\text{是截距，}\delta\text{是需求弹性，}X\text{是决定需求的因素矩阵，如其他商品的价格或收入，}\gamma\text{是} X \text{与} Q_d \text{之间关系的系数，}u\text{是误差项。}$$


展望本书的内容，我们在估算需求的价格弹性时需满足两个条件。首先，我们需要大量涉及价格和数量的数据。其次，我们的数据集中价格的变动需要与误差项 $u$ 保持独立，这种独立性我们称之为外生性。缺一不可，否则我们无法确定需求的价格弹性，因而任何依赖此类信息的决策都将如同在黑暗中摸索。



## 1.5 小结
















***
## 笔记
<div id="comment-5">
    <b>注释 5:</b> "它不是唯一的基石(cornerstone)，甚至不一定是最重要的基石，但实证分析(empirical analysis)在科学工作中一直发挥着重要作用。"
</div>

<div id="comment-6">
    <b>注释 6:</b> 
    <p>假设我们有一个简单的需求曲线数据例子，它表示某商品的价格与消费者需求量之间的关系：</p>
    <table>
        <tr>
            <th>价格 (P)</th>
            <th>需求量 (Q)</th>
        </tr>
        <tr>
            <td>10</td>
            <td>100</td>
        </tr>
        <tr>
            <td>8</td>
            <td>120</td>
        </tr>
        <tr>
            <td>6</td>
            <td>150</td>
        </tr>
        <tr>
            <td>4</td>
            <td>200</td>
        </tr>
        <tr>
            <td>2</td>
            <td>300</td>
        </tr>
    </table>
    随着价格的进一步降低，需求量继续增加。这些价格和需求量的配对就构成了该商品的需求曲线，展示了价格变化如何影响需求量。
</div>

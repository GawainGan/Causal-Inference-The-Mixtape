# 2. 概率与回归回顾 (Probability and Regression Review)

数值永远是抽象的，它们没有情感。但是如果你过分施压，即是是数值也有极限
-- Mos Def

## 2.1 基础概率理论 (Basic probability theory)

实践中，因果推断基于从非常简单到极其先进的统计模型。构建这样的模型需要一些基本的概率论知识，那么让我们从一些定义开始。随机过程是可以多次重复且每次都有不同结果的过程。样本空间是随机过程所有可能结果的集合。我们区分离散和连续随机过程如下[表1](#table-1)所示。离散过程产生整数，而连续过程则产生分数。

#### <a name="table-1"></a>表1. Examples of discrete and continuous random processes.
| Description    | Type       | Potential outcomes      |
|----------------|------------|-------------------------|
| 12-sided die   | Discrete   | 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12|
| Coin           | Discrete   | Heads, Tails            |
| Deck of cards  | Discrete   | 2♠, 3♠, …, King♠, Ace♠  |
| Gas prices     | Continuous |      P ≥ 0              |

我们用两种方式定义独立事件。第一种是逻辑独立。例如，两个事件发生，但没有理由相信这两个事件会相互影响。当假设它们确实相互影响时，这是一种称为***事后因果谬误***（post hoc ergo propter hoc）的逻辑谬误，意为“因此，由此产生”。这种谬误认为，事件的时间顺序不足以说明第一件事导致了第二件事。

独立事件的第二个定义是统计独立性。我们将用一个有关有无替换抽样(sampling without replacement)的例子来说明后者。以一副随机洗好的扑克牌为例。在52张牌中，第一张牌是A的概率是多少？

<p> 
    $$  \Pr(\text{Ace}) =\dfrac{\text{Count Aces}}{\text{Sample Space}}=\dfrac{4}{52}=   \dfrac{1}{13}=0.077 $$
</p> 

*注： 注释：在一副完整的扑克牌中，共有4张A，包括黑桃A、红心A、梅花A和方块A。因此，从这副牌中随机抽取一张牌，得到一张A的概率是A的总数（4张）除以牌的总数（52张）。这个计算反映了在没有任何先验信息的情况下，抽到一张A的概率。*

样本空间中有52种可能的结果，或随机过程的所有可能结果的集合。在这52种可能的结果中，我们关心A出现的频率。牌堆中有4张A，所以4/52=0.077。

假设第一张牌是A。现在我们再次提出这个问题。如果我们洗牌，那么抽到的下一张牌也是A的概率是多少？由于我们没有进行有替换的抽样，所以概率不再是1/13。我们进行了***无替换的抽样***(sampled without replacement)。因此新的概率是

<p> 
    $$ \Pr\Big(\text{Ace}\mid\text{Card } 1 =\text{Ace}\Big) = \dfrac{3}{51}= 0.059 $$
</p> 

在无替换抽样的情况下，"第一张牌是A"和"如果第一张牌是A，那么第二张牌也是A"这两个事件并不独立。为了让这两个事件变得独立，你需要将A牌放回牌堆并重新洗牌。因此，只有在以下条件下，两个事件A和B才是独立的：

<p> 
    $$ \Pr(A\mid B)=\Pr(A) $$
</p> 

两个独立事件的一个例子可能是在用另一个骰子掷出3后，用一个骰子掷出5。这两个事件是独立的，所以不管我们第一次掷出什么，掷出5的概率始终是0.17。
<p> 
    $$ 1/6 = 0.16\overline{6}  $$
</p> 

但如果我们想知道某个事件发生的概率，而这需要多个事件首先发生怎么办？例如，我们说的是克利夫兰骑士队赢得NBA冠军。2016年，金州勇士队在七场四胜制的季后赛中以3-1领先。勇士队输掉季后赛需要发生什么？骑士队必须连赢三场。在这种情况下，要找到概率，我们必须将所有边际概率的乘积相乘，或 <img src="https://latex.codecogs.com/png.latex?Pr(\cdot)^n" alt="Pr(·)^n" style="vertical-align: middle;" /> ，其中 <img src="https://latex.codecogs.com/png.latex?Pr(\cdot)" alt="Pr(·)" style="vertical-align: middle;" /> 是一个事件发生的边际概率，<img src="https://latex.codecogs.com/png.latex?n" alt="n" style="vertical-align: middle;" /> 是那个事件重复的次数。如果骑士队赢得一场比赛的无条件概率是0.5，并且每场比赛都是独立的，那么骑士队从3-1的劣势中反弹赢得冠军的概率就是每场比赛获胜概率的乘积：


<p> 
    $$ \text{Win probability} =\Pr\big(W,W,W\big)= (0.5)^3= 0.125 $$
</p> 
  
*注：也就是说，骑士队从3-1的劣势反弹赢得系列赛的概率是12.5%。*

再举一个例子，有助于理解。在德州扑克中，每位玩家面朝下发两张牌。当你手里有两张相同的牌时，你说你有两张“口袋牌”。那么，被发到口袋A的概率是多少呢？它是 
<p> 
    $$  \dfrac{4}{52}\times\dfrac{3}{51}=0.0045 $$
</p> 

没错，概率是0.45%。


让我们将我们所讨论的内容形式化，以更一般化的案例来阐述。对于独立事件，要计算联合概率，我们需要将边际概率相乘：

其中 Pr(A,B) 是事件 A 和 B 同时发生的联合概率，Pr(A) 是事件 A 发生的边际概率。

现在，让我们来看一个稍微难一点的应用。使用两个六面骰子掷出7点的概率是多少，它和掷出3点的概率相同吗？为了回答这个问题，我们比较两个概率。我们将使用一个表格来帮助解释直觉。首先，让我们看看使用两个六面骰子掷出7点的所有可能方式。掷两个骰子总共有36种可能的结果（6^2=36）。在[表2.2](#table-2-2)  中，我们看到使用两个骰子掷出7点有六种不同的方式。因此，掷出7点的概率是6/36=16.67%。接下来，让我们看看使用两个六面骰子掷出3点的所有方式。[表2.3](#table-2-3)  显示，使用两个六面骰子掷出3点只有两种方式。因此，掷出3点的概率是2/36=5.56%。所以，掷出7点和掷出3点的概率是不同的。

#### <a name="table-2-2"></a>表2.2: Total number of ways to get a 7 with two six-sided dice.
| Die 1 | Die 2 | Outcome |
|-------|-------|---------|
|1|6|7|
|2|5|7|
|3|4|7|
|4|3|7|
|5|2|7|
|6|1|7|

#### <a name="table-2-3"></a>表 2.3: Total number of ways to get a 3 using two six-sided dice.
| Die 1 | Die 2 | Outcome |
|-------|-------|---------|
|1|2|3|
|2|1|3|


## 2.2 事件和条件概率 (Events and conditional probability)
事件和条件概率。在我们讨论表示概率的三种方式之前，我想先介绍一些新的术语和概念：事件(events)和条件概率(conditional probabilities)。设 A 是某个事件，B 是另一个事件。对于两个事件，有四种可能性：

- A 和 B：A 和 B 都发生。
- ∼A 和 B：A 不发生，但 B 发生。
- A 和 ∼B：A 发生，但 B 不发生。
- ∼A 和 ∼B：A 和 B 都不发生。

我将使用几个不同的例子来说明如何表示概率。


## 2.3 概率树 (Probability tree)

让我们想象一个你正在尝试获取驾驶执照的情况。假设为了获得驾驶执照，你必须通过笔试和路考。然而，如果你未通过笔试，就不能参加路考。我们可以在概率树中表示这两个事件。

<p align="center">
    <img src="https://github.com/GawainGan/Causal-Inference-The-Mixtape/blob/main/Source/probability_tree.png?raw=true" style="width: 70%;"/>
</p>

概率树直观且易于解释<sup id="a1">[1](#f1)</sup>。首先，我们看到通过笔试的概率是0.75，而未通过的概率是0.25。其次，从每个节点分叉出去时，我们可以进一步看到与给定分支相关的概率之和为1.0。联合概率之和也为1.0。这称为全概率定律，等于所有事件A和B发生的联合概率之和：
<p> 
    $$ \Pr(A)=\sum_n Pr(A\cap B_n) $$
</p> 

我们还在驾照树中看到了条件概率的概念。例如，在通过了笔试的条件下，未通过路考的概率表示为:
<p> 
    $$ \Pr(未通过 | 通过) = \dfrac{0.45}{0.75} = 0.6 $$
</p> 

## 2.3

第二种表示多个事件发生的方式是使用文氏图。文氏图最初由约翰·文恩在1880年构想出来。它们被用来教授基础集合论，以及在概率统计中表达集合关系。这个例子将涉及两个集合，A和B。

德克萨斯大学的足球教练整个赛季都与体育总监和校董会处于紧张关系。经过几个平庸的赛季，他与学校的未来岌岌可危。如果长角牛队无法进入重要的碗赛，他可能不会被重新聘用。但如果他们能进入，他很可能会被重新聘用。让我们用这位教练的情况作为引导例子来讨论基础集合论。但在我们这样做之前，让我们回顾一下我们的术语。A和B是事件，U是A和B是其子集的全集。设A为长角牛队被邀请参加重要碗赛的概率，B为他们的教练被重新聘用的概率。设Pr(A)=0.6，Pr(B)=0.8。设A和B同时发生的概率为Pr(A,B)=0.5。

注意，A + ～A = U，其中～A是A的补集。补集意味着它是全集中不是A的所有内容。B也是如此。B和～B的和 = U。因此：

<p> 
    $$ A+{\sim} A=B+ {\sim} B $$
</p> 

我们可以重新写出以下定义：

<p> 
    $$ \begin{align}
A & = B+{\sim} B - {\sim} A \
B & = A+{\sim} A - {\sim} B
\end{align} $$
</p> 

每当我们想要描述一组事件，其中A或B可能发生时，它就是：A∪B。这读作“A并B”，意味着它是一个新的集合，包含A和B中的每个元素。因此，如果某个元素在集合A或集合B中，那么它也在新的并集中。每当我们想要描述一起发生的一组事件——即交集时，它就是A∩B，读作“A交B”。这个新集合包含同时在A和B集合中的每个元素。也就是说，只有同时在A和B中的元素才会被添加到新集合中。

现在让我们仔细看看涉及集合A的关系。

<p> 
    $$ \begin{align}
A=A \cap B+A \cap{\sim} B
\end{align} $$
</p> 

注意这是什么意思：有两种方法可以识别A集合。首先，你可以查看所有A与B一起发生的实例。但是，A中不在B中的其余部分怎么办？好吧，那是A∪B的情况，它覆盖了A集合的其余部分。

类似的推理方式可以帮助你理解以下表达式。

<p> 
    $$ A \cup B=A \cap{\sim}B+\sim A \cap B+A \cap B $$
</p> 

为了得到A交B，我们需要三个对象：B之外的A单元集合，A之外的B单元集合，以及它们的交集。你得到了所有这些，你就有了A ∩ B。

现在只需简单的加法就能找到所有缺失的值。回想一下，A是你的团队进入季后赛的概率，Pr(A)=0.6。B是教练被重新聘用的概率，Pr(B)=0.8。同时，Pr(A,B)=0.5，这是A和B同时发生的概率。那么我们有：

<p> 
    $$ \begin{align}
   A              & = A \cap B+A \cap{\sim}B \\
   A \cap{\sim}B  & = A - A \cap B           \\
   \Pr(A, \sim B) & = \Pr(A) - Pr(A,B)       \\
   \Pr(A,\sim B)  & = 0.6 - 0.5              \\
   \Pr(A,\sim B)  & = 0.1                    
\end{align} $$
</p> 

在处理集合时，重要的是要理解，概率是通过考虑集合（例如A）由子集（例如A ∪ B）构成的比例来计算的。当我们说明A ∪ B发生的概率时，是相对于U而言的。但如果我们要问的问题是“A中由于A ∪ B而占的比例是多少？”注意，那么我们需要这样做：

<p> 
    $$ \begin{align}
   ? & = A \cap B \div A \\
   ? & = 0.5 \div 0.6    \\
   ? & = 0.83            
\end{align} $$
</p> 

我故意在左边未定义这个问题，以便专注于计算本身。但现在让我们定义我们想要计算的内容：在A发生的情况下，B也发生的概率是多少？这就是：

<p> 
    $$ \begin{align}
   \Pr(B \mid A)  & = \dfrac{\Pr(A,B)}{\Pr(A)}= \dfrac{0.5}{0.6}=0.83 \\
   \Pr(A \mid B) & = \dfrac{\Pr(A,B)}{\Pr(B)}= \dfrac{0.5}{0.8}=0.63
\end{align} $$
</p> 

注意，这些条件概率在文氏图中并不容易看出。我们实际上是在询问子集（例如Pr(A)）中由于交集（例如Pr(A,B)）造成的百分比是多少。这种推理正是用来定义条件概率概念的相同推理。





<sup id="a0">[0](#f0)</sup>
***
## 笔记

<b>注释 0:</b>
<b id="f0">""</b> [↩](#a0)
<p> </p>


<b>注释 1:</b>
<b id="f1">The set notation <img src="https://latex.codecogs.com/png.latex?%5Ccup" alt="\cup" /> means “union” and refers to two events occurring together. 
集合符号 <img src="https://latex.codecogs.com/png.latex?%5Ccup" alt="\cup" /> 的意思是 "联合"，指两个事件同时发生。</b> [↩](#a1)
<p> </p>


